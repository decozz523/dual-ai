<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dual AI Chat (Bot R & Bot S)</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <div class="layout mode-home">
      <header class="topbar">
        <div class="topbar-left">
          <button id="menuBtn" class="icon-btn" aria-label="Открыть меню">
            <span class="icon">☰</span>
          </button>
          <div class="title">
            <div class="h1">Dual AI Chat</div>
            <div class="subtitle">Bot R (рациональный) + Bot S (творческий) через OpenRouter</div>
          </div>
        </div>
        <div class="topbar-right">
          <div class="status-pill" id="status">Готов.</div>
          <div class="auth-pill" id="authStatus" hidden></div>
          <button id="loginBtn" class="btn btn-secondary">Войти</button>
          <button id="logoutBtn" class="btn btn-secondary" hidden>Выйти</button>
          <button id="homeBtn" class="btn btn-secondary">Главное меню</button>
        </div>
      </header>

      <main class="app">
        <section class="hero">
          <div>
            <div class="hero-title">Профессиональный чат для стратегий и идей</div>
            <div class="hero-subtitle">
              Пара ботов ведёт дискуссию с тобой: рациональный бот структурирует, творческий — расширяет
              варианты. Управляй настройками через меню.
            </div>
          <div class="hero-actions">
              <button id="openDrawerBtn" class="btn btn-secondary">Открыть настройки</button>
              <button id="newChatBtn" class="btn btn-primary">Новый диалог</button>
          </div>
          </div>
          <div class="hero-cards">
            <div class="info-card">
              <div class="info-title">Горячая клавиша</div>
              <div class="info-value">Ctrl / ⌘ + Enter</div>
              <div class="info-hint">Отправляй сообщение без мыши.</div>
            </div>
            <div class="info-card">
              <div class="info-title">Конфиденциальность</div>
              <div class="info-value">Только локально</div>
              <div class="info-hint">Настройки сохраняются в браузере.</div>
            </div>
            <div class="info-card">
              <div class="info-title">Режим диалога</div>
              <div class="info-value">Dual AI</div>
              <div class="info-hint">Bot R + Bot S ведут сессию.</div>
            </div>
          </div>
        </section>

        <section class="chat">
          <div id="messages" class="messages" aria-live="polite"></div>
        </section>

        <section class="composer">
          <div class="composer-head">
            <div>
              <div class="label">Сообщение</div>
              <div class="hint">Опиши задачу, контекст и ожидания — так ответы будут точнее.</div>
            </div>
            <div class="chip">Dual AI Mode</div>
          </div>
          <textarea
            id="input"
            rows="3"
            placeholder="Напиши сообщение…"
          ></textarea>
          <div class="row">
            <button id="sendBtn" class="btn btn-primary">Отправить</button>
            <button id="demoBtn" class="btn btn-secondary">Демо-вопрос</button>
          </div>
        </section>
      </main>
    </div>

    <div id="drawerOverlay" class="drawer-overlay" hidden></div>
    <aside id="drawer" class="drawer" aria-label="Настройки">
      <div class="drawer-head">
        <div>
          <div class="drawer-title">Меню</div>
          <div class="drawer-subtitle">История диалогов и настройки</div>
        </div>
        <button id="closeDrawerBtn" class="icon-btn" aria-label="Закрыть меню">
          <span class="icon">✕</span>
        </button>
      </div>

      <section class="drawer-section">
        <div class="section-title">Диалоги</div>
        <div id="dialogList" class="dialog-list" aria-live="polite"></div>
        <button id="drawerNewChatBtn" class="btn btn-primary">Новый диалог</button>
      </section>

      <section class="drawer-section">
        <div class="section-title">Подключение OpenRouter</div>
        <div class="field">
          <div class="label">OpenRouter API key</div>
          <div class="hint">
            Ключ хранится на сервере через Vercel Environment Variables и не вводится пользователем.
          </div>
        </div>

        <label class="field">
          <div class="label">Модель (OpenRouter slug)</div>
          <select id="model">
            <option value="arcee-ai/trinity-large-preview:free">arcee-ai/trinity-large-preview:free</option>
            <option value="deepseek/deepseek-r1-0528:free">deepseek/deepseek-r1-0528:free</option>
            <option value="stepfun/step-3.5-flash:free">stepfun/step-3.5-flash:free</option>
          </select>
          <div class="hint">Выберите одну из предустановленных моделей.</div>
        </label>
      </section>

      <section class="drawer-section">
        <div class="section-title">Диалог</div>
        <label class="field">
          <div class="label">Авто-диалог ботов (ходов после твоего сообщения)</div>
          <input id="turns" type="number" min="0" max="10" value="0" />
          <div class="hint">0 = только один ответ каждого бота на твоё сообщение.</div>
        </label>
      </section>

      <section class="drawer-section">
        <div class="section-title">Управление</div>
        <div class="row">
          <button id="saveBtn" class="btn">Сохранить настройки</button>
          <button id="clearBtn" class="btn btn-secondary">Очистить чат</button>
        </div>
      </section>
    </aside>

    <div id="authOverlay" class="modal-overlay" hidden></div>
    <div id="authModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="authTitle" hidden>
      <div class="modal-head">
        <div>
          <div class="modal-title" id="authTitle">Вход в аккаунт</div>
          <div class="modal-subtitle">Используем Supabase Email/Password.</div>
        </div>
        <button id="authCloseBtn" class="icon-btn" type="button" aria-label="Закрыть окно" data-close-auth="true">
          <span class="icon">✕</span>
        </button>
      </div>
      <div class="modal-body">
        <label class="field">
          <div class="label">Email</div>
          <input id="authEmail" type="email" placeholder="you@example.com" autocomplete="email" />
        </label>
        <label class="field">
          <div class="label">Пароль</div>
          <input id="authPassword" type="password" placeholder="••••••••" autocomplete="current-password" />
        </label>
        <div id="authMessage" class="auth-message" role="status"></div>
        <div class="auth-hint">
          Если письмо с подтверждением не пришло, проверьте спам или запросите повторную отправку.
        </div>
        <div class="row">
          <button id="authSignInBtn" class="btn btn-primary">Войти</button>
          <button id="authSignUpBtn" class="btn btn-secondary">Создать аккаунт</button>
          <button id="authResendBtn" class="btn btn-secondary">Отправить письмо ещё раз</button>
        </div>
      </div>
    </div>

    <script type="module" src="./app.js"></script>
  </body>
</html>



